<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case Study: Designing for a Nation in Crisis | Kunal Katre</title>
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Serif+JP:wght@600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="gradient-bg"></div>

<nav class="main-nav">
    <a href="index.html" class="nav-logo">Kunal Katre</a>
    <div class="nav-links">
        <div class="nav-dropdown">
            <a href="index.html#journey" class="nav-link-item">The Journey</a>
            <div class="dropdown-content">
                <a href="index.html#act1">Act I: The Foundation</a>
                <a href="index.html#act2">Act II: The Builder</a>
                <a href="index.html#act3">Act III: The Platform Strategist</a>
            </div>
        </div>
        <a href="index.html#process" class="nav-link-item">Design Process</a>
        <a href="cv.html" class="nav-link-item">Résumé</a>
        <a href="index.html#contact" class="nav-link-item">About & Contact</a>
    </div>
</nav>

<div class="container">
    <main class="case-study">

        <!-- Case Study Hero Section -->
        <div class="case-study__hero">
            <div class="hero__text-content">
                <a href="index.html#act2" class="case-study__back-link">← Back to Journey</a>
                <div class="hero__client-logo">
                    <span>Project for</span>
                    <img src="assets/eka-logo.svg" alt="Eka Care logo">
                </div>
                <h1>Designing for a Nation in Crisis</h1>
                <p class="hero__summary">I led the design for a platform that navigated extreme public anxiety and technical chaos to facilitate over 2 crore vaccine certificate downloads.</p>
                <div class="hero__stats">
                    <div class="stat-item">
                        <span class="stat-value">+2 Crore</span>
                        <span class="stat-label">Vaccine Certificates</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">#1</span>
                        <span class="stat-label">on Google Search</span>
                    </div>
                    <!-- <div class="stat-item">
                        <span class="stat-value">Lead</span>
                        <span class="stat-label">Product Designer</span>
                    </div> -->
                    <div class="stat-item">
                        <span class="stat-value">~2 Months</span>
                        <span class="stat-label">Initial Launch</span>
                    </div>
                </div>
            </div>
            <div class="hero__visual-content">
                <div class="device-mockup" style="width: 375px; height: 812px;">
                    <img src="assets/cowin/cowin-hero-visual.png" alt="Eka Care app showing the Co-WIN certificate download interface" style="width: 100%; height: 100%; object-fit: cover; border-radius: 28px;">
                </div>
            </div>
        </div>
        <!-- End of Hero Section -->

        <div class="case-study-layout">

            <div class="case-study__content">
                <!-- =================================================================== -->
                <!-- SECTION 1: THE SETUP -->
                <!-- =================================================================== -->
                <section id="setup">
                    <h2 class="act-title">1. The Setup: A High-Stakes Mandate</h2>
                    <p>In 2021, India faced a monumental challenge: vaccinating its population amidst a devastating pandemic wave. The government released the Co-WIN APIs, creating a sudden, urgent opportunity. The business goal for Eka.Care was clear: leverage these APIs to build a superior, trustworthy public utility that could capture a massive, anxious user base and establish us as a key player in India's digital health ecosystem.</p>
                    
                    <h4>The User's Reality: A State of Panic</h4>
                    <p>The public sentiment was not one of simple "user needs"; it was a state of crisis. My rapid research into online forums, social media, and news reports revealed the core user anxieties:</p>
                    <div class="insights-grid">
                        <div class="insight-card">
                            <div class="insight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg></div>
                            <h5>Availability Anxiety</h5>
                            <blockquote>"Will I ever find a slot for my elderly parents? I've been trying for days."</blockquote>
                        </div>
                        <div class="insight-card">
                             <div class="insight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg></div>
                            <h5>Trust & Legitimacy</h5>
                            <blockquote>"Is this third-party app even legitimate? How do I know it's safe to give them my Aadhar number?"</blockquote>
                        </div>
                        <div class="insight-card">
                             <div class="insight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg></div>
                            <h5>Information Gaps</h5>
                            <blockquote>"How do I know this information is real and not a waste of my time? Is the slot even still there?"</blockquote>
                        </div>
                    </div>
                    
                    <h4>My Role: Designer as a De-risking Agent</h4>
                    <p>As the sole designer on this initiative, I was tasked with creating a functional UX under an extreme "one-day delivery mode" timeline. With no PM, my role expanded significantly. I was responsible for de-risking the project by defining requirements, analyzing technical constraints, and creating a clear plan of action that the entire cross-functional team could rally behind.</p>
                </section>


                <!-- =================================================================== -->
                <!-- SECTION 2: DISCOVERY -->
                <!-- =================================================================== -->
                <!-- [REPLACE THIS ENTIRE SECTION] -->
<section id="research">
    <h2 class="act-title">2. Discovery: Finding Signal in the Noise</h2>
    <p>The existing official portal was functional but overwhelmed, creating a significant "trust gap." Users were desperate for an alternative that was not just faster, but clearer and more reliable. My discovery process started with the technology itself to understand our exact capabilities.</p>

    <h4>Deconstructing the Technical Foundation</h4>
    <p>My first step was a deep dive into the technical foundation—the Co-WIN APIs. Instead of just reading the docs, I deconstructed them into a clear, grouped list to understand our building blocks. This helped the entire team, including non-technical stakeholders, grasp what was possible.</p>

    <!-- [NEW] API Docs Component -->
    <div class="api-docs-container">
        <div class="api-section">
            <details>
                <summary>
                    <h4>Metadata APIs</h4>
                    <div class="chevron"></div>
                </summary>
                <div class="api-list">
                    <div class="api-endpoint">
                        <span class="api-method get">GET</span>
                        <code class="api-path">/v2/admin/location/states</code>
                        <span class="api-description">Get states</span>
                    </div>
                    <div class="api-endpoint">
                        <span class="api-method get">GET</span>
                        <code class="api-path">/v2/admin/location/districts/{state_id}</code>
                        <span class="api-description">Get list of districts</span>
                    </div>
                </div>
            </details>
        </div>
        <div class="api-section">
            <details open>
                <summary>
                    <h4>Appointment Availability APIs</h4>
                    <div class="chevron"></div>
                </summary>
                <div class="api-list">
                    <div class="api-endpoint">
                        <span class="api-method get">GET</span>
                        <code class="api-path">/v2/appointment/sessions/public/findByPin</code>
                        <span class="api-description">Get vaccination sessions by PIN</span>
                    </div>
                    <div class="api-endpoint">
                        <span class="api-method get">GET</span>
                        <code class="api-path">/v2/appointment/sessions/public/findByDistrict</code>
                        <span class="api-description">Get vaccination sessions by district</span>
                    </div>
                    <div class="api-endpoint">
                        <span class="api-method get">GET</span>
                        <code class="api-path">/v2/appointment/centers/public/findByLatLong</code>
                        <span class="api-description">Get vaccination centers by latitude and longitude. [Draft]</span>
                    </div>
                    <div class="api-endpoint">
                        <span class="api-method get">GET</span>
                        <code class="api-path">/v2/appointment/sessions/public/calendarByPin</code>
                        <span class="api-description">Get vaccination sessions by PIN for 7 days</span>
                    </div>
                     <div class="api-endpoint">
                        <span class="api-method get">GET</span>
                        <code class="api-path">/v2/appointment/sessions/public/calendarByDistrict</code>
                        <span class="api-description">Get vaccination sessions by district for 7 days</span>
                    </div>
                     <div class="api-endpoint">
                        <span class="api-method get">GET</span>
                        <code class="api-path">/v2/appointment/sessions/public/calendarByCenter</code>
                        <span class="api-description">Get vaccination sessions by center for 7 days. [Draft]</span>
                    </div>
                </div>
            </details>
        </div>
        <div class="api-section">
            <details>
                <summary>
                    <h4>Certificate APIs</h4>
                    <div class="chevron"></div>
                </summary>
                <div class="api-list">
                    <div class="api-endpoint">
                        <span class="api-method get">GET</span>
                        <code class="api-path">/v2/registration/certificate/public/download</code>
                        <span class="api-description">Download vaccination certificate in PDF format by beneficiary reference id
                            <svg class="lock-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M12 1.5A5.25 5.25 0 006.75 6.75v3H6a3 3 0 00-3 3v6a3 3 0 003 3h12a3 3 0 003-3v-6a3 3 0 00-3-3h-.75v-3A5.25 5.25 0 0012 1.5zM8.25 6.75a3.75 3.75 0 017.5 0v3h-7.5v-3z"></path></svg>
                        </span>
                    </div>
                </div>
            </details>
        </div>
    </div>

    <h4>The "Search Near Me" Insight</h4>
    <div class="highlight-box">
        <p><strong>Key Insight:</strong> While the APIs provided basic search by PIN and District, I identified a critical gap: there was no single API for a simple, location-aware "search near me." Competitors were just replicating the basic government portal forms, forcing users to manually find and enter their PIN or district.</p>
        <p><strong>My Strategic Solution:</strong> I proposed a new user flow. By first requesting the user's device location (with their permission), we could programmatically determine their current Pincode. We could then feed this data into the existing <code>.../findByPin</code> API. This seemingly small step created a "one-tap" search experience that was vastly superior and less stressful for a user in a panic. It became our single biggest UX differentiator.</p>
    </div>

    <h4>Mapping the Anxiety Journey</h4>
    <p>This technical understanding, combined with the "Search Near Me" insight, allowed me to frame the user's emotional state. I synthesized this into a journey map that became our team's guiding star, ensuring we focused on reducing anxiety at every step.</p>
    <figure class="case-study__image zoomable">
        <img src="assets/cowin/fig2-failure-map.png" alt="A simplified User Journey Map showing stages like 'Initial Panic,' 'Search for Hope,' 'Evaluate Options,' and 'The Final Confirmation.'">
        <figcaption>Fig.1 - I mapped the user's emotional journey to align the team on our primary goal: reducing anxiety. (Click to zoom)</figcaption>
    </figure>
</section>

                <!-- =================================================================== -->
                <!-- SECTION 3: DESIGN GOALS -->
                <!-- =================================================================== -->
                <section id="goals">
                    <h2 class="act-title">3. The Three Pillars of Trust</h2>
                    <p>Based on the journey map and user anxieties, I established three core design principles that became our unwavering guide for every feature and decision.</p>
                    <div class="goals-grid">
                        <div class="goal-card">
                            <div class="goal-number">1</div>
                            <h3>Radical Transparency</h3>
                            <p>Show everything, hide nothing. To build trust, we had to be more comprehensive and forthcoming than the official sources, even if it meant showing "bad news" (like no available slots).</p>
                        </div>
                         <div class="goal-card">
                            <div class="goal-number">2</div>
                            <h3>Honest Expectation Management</h3>
                            <p>Never overpromise. Be explicit about data freshness and potential failures to prevent the user frustration that comes from chasing non-existent "ghost" slots.</p>
                        </div>
                         <div class="goal-card">
                            <div class="goal-number">3</div>
                            <h3>Anxiety-Proof Confirmation</h3>
                            <p>The end of the flow must be a definitive, reassuring "contract" that contains every piece of necessary information, leaving absolutely no room for doubt or last-minute questions.</p>
                        </div>
                    </div>
                </section>

                <!-- =================================================================== -->
                <!-- SECTION 4: DESIGN & EXECUTION -->
                <!-- =================================================================== -->
                <section id="design">
                    <h2 class="act-title">4. Design & Execution</h2>
                    <p>Guided by our three pillars of trust, I designed the two most critical user journeys: booking a slot and downloading a certificate. The execution focused on providing clarity and control at every step, transforming high-anxiety tasks into reassuring experiences. The following sections break down the final flows and the specific design decisions that made them effective.</p>

                    <div class="flowchart-container journey-flowchart zoomable">
                        <div class="mermaid">
                           graph TD
                                A(Start) --> B[Select 'Co-WIN Services'];
                                B --> C{Choose Task};

                                subgraph "Download Certificate Flow"
                                    C --> C1[Download Certificate];
                                    C1 --> D[Authenticate via OTP];
                                    D --> E[Select Beneficiary];
                                    E --> F[Download Successful];
                                    F --> G[View Rich Success Page <br><em>Incl. Cross-Sell & Next Steps</em>];
                                end
                                
                                subgraph "Book Slot Flow"
                                    C --> C2[Book Slot];
                                    C2 --> H[Authenticate via OTP];
                                    H --> I{Search Method};
                                    I --> I1[By Pin Code];
                                    I --> I2[By District];
                                    I1 --> J[View Results];
                                    I2 --> J;
                                    J --> K[Select Center & Slot];
                                    K --> L[Confirm Booking];
                                    L --> M[Booking Success Page];
                                end

                                subgraph "Link Passport Flow"
                                    C --> C3[Link Passport];
                                    C3 --> N[Authenticate via OTP];
                                    N --> O[Select Beneficiary];
                                    O --> P[Enter Passport Details];
                                    P --> Q[Submit & Confirm];
                                    Q --> R[Linking Success Page];
                                end

                                classDef core fill:#eef2f7,stroke:#3d5a80,stroke-width:2px,color:#3d405b,font-weight:bold;
                                class A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R core;
                        </div>
                       <figcaption>Fig. 2 - The complete Co-WIN services user flow, mapping all critical paths from a single entry point. (Click to zoom & pan)</figcaption>
                   </div>

                   <h3>4.1 Flow: Booking a Vaccination Slot</h3>
                   <p>The slot booking process was the epicenter of user anxiety. My goal was to create a flow that was not only functional but actively worked to calm the user. I designed it to provide maximum information and control, ensuring users felt guided and empowered, not lost in a chaotic race for slots.</p>
                   
                   <figure class="case-study__visual-artifact">
                       <img src="assets/cowin/book-flow-1.png" alt="The complete user flow for booking a vaccination slot, from the beneficiary list to the final confirmation screen.">
                       <figcaption>Fig. 2 - The final booking flow, designed for clarity, transparency, and anxiety reduction at every step.</figcaption>
                   </figure>

                   <h4>Highlights & Design Rationale:</h4>
                   <div class="highlight-list">
                       <div class="highlight-item">
                           <h5>1. Proactive Filtering & Absolute Transparency (Search Results)</h5>
                           <p>Instead of hiding "bad news," we embraced it. The search results page showed <strong>all</strong> vaccination centers, clearly marking those with no available slots. This upheld our "Radical Transparency" principle, proving to the user that our data was comprehensive and trustworthy. For booked-out centers, we added a "Notify me" button—a small feature that provided immense hope and turned a dead end into a future opportunity.</p>
                       </div>
                       <div class="highlight-item">
                           <h5>2. Automated Slot Reservation (Auto Vaccine slot booking)</h5>
                           <p>One of the biggest user frustrations was "ghost slots"—slots that vanished the instant they were selected. To combat this, I designed an intermediate "booking in progress" screen. When a user selected a center, our system would attempt to hold a slot for a short period (e.g., 60 seconds). This small buffer transformed the experience from a frantic race into a more controlled process, assuring the user that the app was actively working on their behalf.</p>
                       </div>
                       <div class="highlight-item">
                           <h5>3. The Anxiety-Proof Confirmation (Appointment Confirmed)</h5>
                           <p>The final confirmation screen was designed as an "anxiety-proof contract." It contained every critical piece of information: Hospital Name, Address, Date, Time, Beneficiary Name, Reference ID, and Vaccine Type. By over-communicating at this final step, we left no room for doubt or last-minute questions, ensuring the user could confidently proceed to their appointment.</p>
                       </div>
                   </div>

                   <!-- 4.2 DOWNLOAD FLOWS -->
                   <h3>4.2 Flows: Downloading the Vaccine Certificate</h3>
                   <p>The certificate download was our single biggest user acquisition channel. Recognizing that users would arrive with different contexts and levels of urgency, I designed two distinct "smart" flows to get them their certificate as frictionlessly as possible.</p>

                   <h4>Path 1: The Direct Download Flow</h4>
                   <p>This path was for the user who arrives with a clear, singular goal: "I need my certificate now." The entire flow was optimized for speed and clarity.</p>
                   <figure class="case-study__visual-artifact">
                       <img src="assets/cowin/download-flow-1.png" alt="The user flow for directly downloading a Co-WIN certificate, from the homepage to the file being saved in the app.">
                       <figcaption>Fig. 3 - The explicit download flow, initiated by the user from a clear call-to-action on the homepage.</figcaption>
                   </figure>
                   
                   <h4>Highlights & Design Rationale:</h4>
                   <div class="highlight-list">
                       <div class="highlight-item">
                           <h5>1. A Clear, Task-Based Entry Point (Homepage Trigger)</h5>
                           <p>We placed a prominent "Download Vaccination Certificate" card on the homepage. This clear, task-oriented entry point eliminated ambiguity and allowed users to immediately self-identify their goal and begin the process without navigating complex menus.</p>
                       </div>
                       <div class="highlight-item">
                           <h5>2. Seamless Integration into the "Files" Vault (Landing on "File")</h5>
                           <p>After a successful download, we didn't just save the PDF to the device's downloads folder and abandon the user. We automatically imported it into the app's "My Files" section. This was a key strategic decision to increase retention. It transformed a one-time utility into a permanent health record vault, giving users a compelling reason to return to Eka.Care.</p>
                       </div>
                   </div>

                   <h4>Path 2: The Proactive "Smart Download" Flow</h4>
                   <p>This was our "magic moment" flow. It was designed for existing users who might not even be thinking about their certificate. The app would proactively work for them in the background, creating a delightful and surprising experience.</p>
                   <figure class="case-study__visual-artifact">
                       <img src="assets/cowin/download-flow-2.png" alt="The automated flow where the app proactively downloads certificates for vaccinated beneficiaries and notifies the user.">
                       <figcaption>Fig. 4 - The proactive, automated flow that fetches certificates in the background, turning a chore into a delightful surprise.</figcaption>
                   </figure>

                   <h4>Highlights & Design Rationale:</h4>
                   <div class="highlight-list">
                       <div class="highlight-item">
                           <h5>1. Context-Aware Automation (Auto download of certificate)</h5>
                           <p>When a user logged in to check their family's vaccination status, our system would intelligently identify beneficiaries who were fully vaccinated but whose certificates weren't yet in the Eka Vault. It would then automatically fetch the certificates in the background, indicated by a subtle "Downloading..." status. This proactive assistance saved the user a step they didn't even know they needed to take.</p>
                       </div>
                       <div class="highlight-item">
                           <h5>2. Turning Success into Engagement (Notifying the download complete)</h5>
                           <p>The confirmation wasn't a simple "Done." It was a rich, contextual pop-up that celebrated the success ("We found vaccine certificates for...") and immediately demonstrated the value of our platform ("Store & share your medical records in a secure vault."). This transformed a background task into a powerful cross-sell moment, using the trust and delight we'd just earned to deepen engagement with our core Eka Vault feature.</p>
                       </div>
                   </div>
                </section>
                


                <!-- =================================================================== -->
                <!-- SECTION 5: IMPACT & LEARNINGS -->
                <!-- =================================================================== -->
                <section id="impact">
                    <h2 class="act-title">5. Impact: Dominating the Market Through Trust</h2>
                    <p>Our principle-led approach was a monumental success. By focusing relentlessly on user anxiety, we built one of the most trusted and widely-used vaccination tools in the country, becoming a primary national resource and Eka.Care's single biggest growth engine.</p>
                    
                    <figure class="case-study__visual-artifact">
                         <div class="metrics-dashboard">
                            <div class="metrics-grid">
                                <div class="metric-card"><h5>App Store Rank</h5><p class="metric-value metric-value--large">#1</p><p class="metric-label">in Health & Fitness</p></div>
                                <div class="metric-card"><h5>Peak Throughput</h5><p class="metric-value metric-value--large">1.4L+</p><p class="metric-label">Certificates / Day</p></div>
                                <div class="metric-card"><h5>Organic Installs</h5><p class="metric-value metric-value--large">~8K</p><p class="metric-label">Daily at peak</p></div>
                                <div class="metric-card"><h5>Total Downloads</h5><p class="metric-value metric-value--large">2 Cr+</p><p class="metric-label">Vaccine Certificates</p></div>
                            </div>
                        </div>
                        <figcaption>Fig. 2 - The feature's focus on a clear, anxiety-reducing flow drove massive organic growth and platform adoption.</figcaption>
                    </figure>

                    <h3>Key Learnings & Reflections</h3>
                    <ul>
                        <li><strong>In a Crisis, Clarity is the Most Valuable Feature.</strong> This project was a powerful lesson in context-driven design. The "best" design isn't always the cleanest or most minimal; in this case, it was the most explicit, reassuring, and information-dense.</li>
                        <li><strong>Lead with Artifacts, Not Opinions.</strong> In a high-speed, low-spec environment, well-designed artifacts (journey maps, user flows, annotated wireframes) are the fastest way to create alignment and de-risk development. They become the plan when there's no time to write one.</li>
                        <li><strong>Design the System, Not Just the Screen.</strong> Our biggest wins came from thinking about the entire user journey—from managing expectations *before* the search to providing value *after* the download. This systemic approach is what created sustainable trust and growth.</li>
                    </ul>
                </section>

                <section class="next-case-study">
                    <h3>Next Case Study</h3>
                    <a href="case-study-heart-rate.html" class="project-card-link">
                        <article class="project-card project-card--next">
                            <div class="project-card__thumbnail"><img src="assets/thumb-hr.png" alt="Thumbnail for Heart Rate Monitor case study"></div>
                            <div class="card-content-wrapper">
                                 <h4 class="project-card__title">Architecting an Engagement Engine</h4>
                                <p class="project-card__description">See how I transformed a failing feature into a core driver of user retention and business value.</p>
                                <span class="project-card__cta">Explore the Heart Rate Project →</span>
                            </div>
                        </article>
                    </a>
                </section>
            </div>
            
            <aside class="case-study-toc-sidebar">
                <nav aria-label="Case study sections">
                    <h4>On this page</h4>
                    <div class="toc-links-wrapper">
                        <a href="#setup" class="is-active">1. The Setup</a>
                        <a href="#research">2. Discovery</a>
                        <a href="#goals">3. The Three Pillars</a>
                        <a href="#design">4. Design & Execution</a>
                        <a href="#impact">5. Impact & Learnings</a>
                    </div>
                </nav>
            </aside>
        </div>
    </main>
</div>

<!-- Universal Lightbox for Images and SVGs -->
<div id="lightbox" class="lightbox">
    <button class="lightbox__close" aria-label="Close zoomed view">×</button>
    <div class="lightbox__content">
        <!-- Zoomable content will be injected here by JS -->
    </div>
    <div class="lightbox__controls">
        <button class="lightbox__control" id="zoom-in" aria-label="Zoom in">+</button>
        <button class="lightbox__control" id="zoom-out" aria-label="Zoom out">-</button>
        <button class="lightbox__control" id="zoom-reset" aria-label="Reset zoom">Reset</button>
    </div>
</div>

<script src="script.js"></script>

<!-- Load Mermaid JS -->
<script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.mjs';
    await mermaid.run(); // Use run() to render all elements with class="mermaid"
</script>

<!-- Load SVG Pan Zoom and Custom Lightbox Script -->
<script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- Tab & Explorer Logic (from your existing script) ---
    document.querySelectorAll('.intervention-container').forEach(container => {
        const tabs = container.querySelectorAll('.intervention-tab');
        const contents = container.querySelectorAll('.intervention-content');
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('is-active'));
                tab.classList.add('is-active');
                const targetContent = container.querySelector(`.intervention-content[data-tab="${tab.dataset.tab}"]`);
                contents.forEach(c => c.classList.remove('is-active'));
                if (targetContent) targetContent.classList.add('is-active');
            });
        });
    });

    document.querySelectorAll('.iteration-explorer').forEach(container => {
        const controls = container.querySelectorAll('.explorer-controls button');
        images = container.querySelectorAll('.explorer-visuals .iteration-image, .explorer-visuals video');
        const rationales = container.querySelectorAll('.explorer-rationale .rationale-text');
        
        controls.forEach(control => {
            control.addEventListener('click', () => {
                const iteration = control.dataset.iteration;
                controls.forEach(c => c.classList.remove('is-active'));
                control.classList.add('is-active');
                images.forEach(img => img.classList.toggle('is-active', img.dataset.iteration === iteration));
                rationales.forEach(rat => rat.classList.toggle('is-active', rat.dataset.iteration === iteration));
            });
        });
    });

    // --- [NEW] UNIVERSAL LIGHTBOX SCRIPT ---
    const lightbox = document.getElementById('lightbox');
    if (!lightbox) return;

    const lightboxContent = lightbox.querySelector('.lightbox__content');
    const closeButton = lightbox.querySelector('.lightbox__close');
    const zoomInButton = document.getElementById('zoom-in');
    const zoomOutButton = document.getElementById('zoom-out');
    const zoomResetButton = document.getElementById('zoom-reset');
    
    let currentPanZoom;
    let imagePanState = {};
    
    function openLightbox(element) {
        lightboxContent.innerHTML = '';
        
        const contentClone = element.cloneNode(true);
        lightboxContent.appendChild(contentClone);
        
        lightbox.classList.add('is-visible');
        document.body.style.overflow = 'hidden';

        const svgElement = contentClone.querySelector('svg');
        const imgElement = contentClone.matches('img') ? contentClone : contentClone.querySelector('img');

        if (svgElement) {
            svgElement.style.cursor = 'grab';
            currentPanZoom = svgPanZoom(svgElement, {
                zoomEnabled: true, controlIconsEnabled: false, fit: true, center: true, minZoom: 0.5, maxZoom: 10,
                onPan: () => svgElement.style.cursor = 'grabbing',
                beforePan: () => svgElement.style.cursor = 'grab',
            });
            zoomInButton.onclick = () => currentPanZoom.zoomIn();
            zoomOutButton.onclick = () => currentPanZoom.zoomOut();
            zoomResetButton.onclick = () => currentPanZoom.reset();
        } else if (imgElement) {
            imgElement.style.cursor = 'grab';
            let scale = 1, panning = false, pointX = 0, pointY = 0, start = { x: 0, y: 0 };

            function setTransform() {
                imgElement.style.transform = `translate(${pointX}px, ${pointY}px) scale(${scale})`;
            }

            imagePanState.setTransform = setTransform;
            imagePanState.scale = (s) => { scale = Math.min(Math.max(0.5, s), 10); setTransform(); };
            imagePanState.reset = () => { scale = 1; pointX = 0; pointY = 0; setTransform(); };

            imgElement.onmousedown = e => {
                e.preventDefault();
                start = { x: e.clientX - pointX, y: e.clientY - pointY };
                panning = true;
                imgElement.style.cursor = 'grabbing';
            };

            imgElement.onmouseup = () => { panning = false; imgElement.style.cursor = 'grab'; };
            imgElement.onmouseleave = () => { panning = false; imgElement.style.cursor = 'grab'; };
            imgElement.onmousemove = e => {
                if (!panning) return;
                pointX = e.clientX - start.x;
                pointY = e.clientY - start.y;
                setTransform();
            };
            imgElement.onwheel = e => {
                e.preventDefault();
                let xs = (e.clientX - pointX) / scale, ys = (e.clientY - pointY) / scale;
                let delta = (e.wheelDelta ? e.wheelDelta : -e.deltaY);
                scale = (delta > 0) ? scale * 1.2 : scale / 1.2;
                imagePanState.scale(scale);
                pointX = e.clientX - xs * scale;
                pointY = e.clientY - ys * scale;
                setTransform();
            }
            
            zoomInButton.onclick = () => { imagePanState.scale(scale * 1.2); };
            zoomOutButton.onclick = () => { imagePanState.scale(scale / 1.2); };
            zoomResetButton.onclick = () => { imagePanState.reset(); };
        }
    }

    function closeLightbox() {
        if (currentPanZoom) {
            currentPanZoom.destroy();
            currentPanZoom = null;
        }
        imagePanState = {};
        lightbox.classList.remove('is-visible');
        document.body.style.overflow = 'auto';
    }
    
    document.querySelectorAll('.zoomable').forEach(el => {
        el.addEventListener('click', (e) => {
            e.preventDefault();
            let targetElement = e.target.closest('.explorer-visuals') || e.target.closest('.zoomable');
             if (targetElement.classList.contains('explorer-visuals')) {
                targetElement = targetElement.querySelector('.iteration-image.is-active, video.is-active');
                if (targetElement && targetElement.tagName === 'VIDEO') {
                    // Don't open lightbox for videos, just play them.
                    targetElement.play();
                    return;
                }
                targetElement = targetElement.querySelector('img');
             } else if (targetElement.classList.contains('zoomable') && !targetElement.querySelector('img') && !targetElement.querySelector('svg')) {
                // This handles cases where the zoomable container is clicked but the image is a child
                targetElement = targetElement.querySelector('img') || targetElement.querySelector('svg');
             }
            if(targetElement) openLightbox(targetElement);
        });
    });
    
    closeButton.addEventListener('click', closeLightbox);
    lightbox.addEventListener('click', e => { if (e.target === lightbox) closeLightbox(); });
    document.addEventListener('keydown', e => { if (e.key === "Escape") closeLightbox(); });

});
</script>

</body>
</html>

<!-- [NOTE: Placeholder images are used. Replace with your actual asset paths e.g., assets/cowin/search-v1.png] -->

<style>

/* --- [NEW] API Docs Component CSS --- */
.api-docs-container {
    --api-border-color: #e5e7eb;
    --api-bg-color: #ffffff;
    --api-header-bg: #f9fafb;
    --api-get-bg: #3b82f6;
    --api-get-text: #ffffff;
    --api-text-main: #1f2937;
    --api-text-muted: #6b7280;

    margin: var(--spacing-xl) 0;
    font-family: var(--font-family-sans);
}
.api-section details {
    border: 1px solid var(--api-border-color);
    border-radius: var(--border-radius);
    margin-bottom: var(--spacing-md);
    background-color: var(--api-bg-color);
    overflow: hidden; /* Ensures rounded corners are respected by children */
}
.api-section summary {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-md) var(--spacing-lg);
    cursor: pointer;
    background-color: var(--api-header-bg);
    list-style: none; /* Hide default marker */
}
.api-section summary::-webkit-details-marker {
    display: none; /* Hide default marker for Safari */
}
.api-section summary h4 {
    margin: 0;
    font-family: var(--font-family-sans);
    font-weight: 600;
    font-size: 1.1rem;
    color: var(--api-text-main);
}
.api-section .chevron {
    width: 20px;
    height: 20px;
    border-right: 2px solid var(--api-text-muted);
    border-bottom: 2px solid var(--api-text-muted);
    transform: rotate(45deg);
    transition: transform 0.2s ease-in-out;
}
.api-section details[open] > summary .chevron {
    transform: rotate(225deg);
}
.api-list {
    padding: var(--spacing-sm);
}
.api-endpoint {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    padding: var(--spacing-md);
    border-radius: 6px;
    transition: background-color 0.2s ease;
}
.api-endpoint:hover {
    background-color: var(--api-header-bg);
}
.api-method {
    padding: 4px 12px;
    border-radius: 4px;
    font-weight: 700;
    font-size: 0.9rem;
    flex-shrink: 0;
}
.api-method.get {
    background-color: var(--api-get-bg);
    color: var(--api-get-text);
}
.api-path {
    font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
    font-size: 0.95rem;
    color: var(--api-text-main);
}
.api-description {
    margin-left: auto;
    font-size: 0.95rem;
    color: var(--api-text-muted);
    text-align: right;
    display: flex;
    align-items: center;
    gap: 8px;
}
.lock-icon {
    color: var(--api-text-muted);
    opacity: 0.7;
}

/* Add some space to the highlight box after the API component */
.highlight-box {
    margin-top: var(--spacing-xl);
}


/* --- [NEW] Highlight List Component CSS --- */
.highlight-list {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xl);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
}
.highlight-item {
    padding-left: var(--spacing-lg);
    border-left: 3px solid var(--color-primary);
}
.highlight-item h5 {
    margin: 0 0 var(--spacing-xs) 0;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--color-text-strong);
}
.highlight-item p {
    margin: 0;
    font-size: 1rem;
    color: var(--color-text);
    line-height: 1.6;
}
.case-study__visual-artifact {
    margin: var(--spacing-xl) 0;
}
.case-study__visual-artifact img {
    width: 100%;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    border: 1px solid #e5e7eb;
}
.case-study__visual-artifact figcaption {
    margin-top: var(--spacing-md);
    font-size: 0.9rem;
    color: var(--color-text-muted);
    text-align: center;
}
</style>

</body>
</html>